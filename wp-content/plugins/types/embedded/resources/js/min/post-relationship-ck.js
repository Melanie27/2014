function wpcfPrIsEdited(){return jQuery(".wpcf-pr-edited").length<1?!1:!0}function wpcfPrUpdateIDs(e){var t;for(t in e)jQuery("#wpcf-post-relationship table td").find(':input[name^="wpcf_post_relationship['+t+']"]').each(function(){jQuery(this).attr("name",jQuery(this).attr("name").replace("["+t+"]","["+e[t]+"]"))})}function wpcfRelationshipInit(e,t){window.wpcfRelationshipInitContext=t,jQuery(e+".wpcf-pr-has-entries").each(function(){var e=jQuery(this);jQuery(this).find("table").each(function(){var i=jQuery(this),n=wpcfRelationshipHasChildren(i);if("add"==t){var r=wpcfRelationshipFirstChildAdded(i);if(r)return window.wpcfRelationshipInitContex="forced",e.find(".wpcf-pr-save-all-link").removeAttr("disabled").trigger("click"),window.wpcfRelationshipInitContex=t,!1}0==n?(i.css("visibility","hidden"),e.find(".wpcf-pagination-boottom").css("visibility","hidden"),e.find(".wpcf-pr-save-all-link").attr("disabled","disabled")):(i.css("visibility","visible"),e.find(".wpcf-pagination-boottom").css("visibility","visible"),e.find(".wpcf-pr-save-all-link").removeAttr("disabled"))})})}function wpcfRelationshipHasChildren(e){return e.find("tbody tr").length>0}function wpcfRelationshipFirstChildAdded(e){return 1==e.find("tbody tr").length}window.wpcfRelationshipInitContext="init",jQuery(document).ready(function(){window.wpcf_pr_edited=!1,jQuery("#wpcf-post-relationship table").find(":input").live("click",function(){window.wpcf_pr_edited=!0,jQuery(this).parent().addClass("wpcf-pr-edited")}),jQuery(".wpcf-pr-has-apply").click(function(){jQuery(this).parent().slideUp().parent().parent().find(".wpcf-pr-edit").fadeIn();var e=new Array;if(jQuery(this).parent().find("input:checked").each(function(){e.push(jQuery(this).next().html())}),e.length<1)var t=wpcf_pr_has_empty_txt;else var i=e.join(", "),t=wpcf_pr_has_txt.replace("%s",i);jQuery(this).parent().parent().parent().find(".wpcf-pr-has-summary").html(t)}),jQuery(".wpcf-pr-belongs-apply").click(function(){jQuery(this).parent().slideUp().parent().parent().find(".wpcf-pr-edit").fadeIn();var e=new Array;if(jQuery(this).parent().find("input:checked").each(function(){e.push(jQuery(this).next().html())}),e.length<1)var t=wpcf_pr_belongs_empty_txt;else var i=e.join(", "),t=wpcf_pr_belongs_txt.replace("%s",i);jQuery(this).parent().parent().parent().find(".wpcf-pr-belongs-summary").html(t)}),jQuery(".wpcf-pr-has-cancel").click(function(){jQuery(this).parent().find(".checkbox").removeAttr("checked");for(var e in window.wpcf_pr_has_snapshot)jQuery("#"+window.wpcf_pr_has_snapshot[e]).attr("checked","checked");jQuery(this).parent().slideUp().parent().parent().find(".wpcf-pr-edit").fadeIn()}),jQuery(".wpcf-pr-belongs-cancel").click(function(){jQuery(this).parent().find(".checkbox").removeAttr("checked");for(var e in window.wpcf_pr_belongs_snapshot)jQuery("#"+window.wpcf_pr_belongs_snapshot[e]).attr("checked","checked");jQuery(this).parent().slideUp().parent().parent().find(".wpcf-pr-edit").fadeIn()}),jQuery(".wpcf-pr-edit").click(function(){window.wpcf_pr_has_snapshot=new Array,window.wpcf_pr_belongs_snapshot=new Array;var e=jQuery(this).attr("id");"wpcf-pr-has-edit"==e?jQuery(this).next().find(".checkbox:checked").each(function(){window.wpcf_pr_has_snapshot.push(jQuery(this).attr("id"))}):jQuery(this).next().find("input:checked").each(function(){window.wpcf_pr_belongs_snapshot.push(jQuery(this).attr("id"))}),jQuery(this).fadeOut().next().slideDown()}),jQuery(".wpcf-pr-ajax-link").live("click",function(){var e=jQuery(this);return jQuery.ajax({url:jQuery(this).attr("href"),type:"get",dataType:"json",cache:!1,beforeSend:function(){e.after('<div style="margin-top:20px;"></div>').next().addClass("wpcf-ajax-loading-small")},success:function(t){null!=t&&"undefined"!=typeof t.output&&(e.parent().find("tbody").prepend(t.output),wpcfRelationshipInit("","add")),e.next().fadeOut(function(){jQuery(this).remove()})}}),!1}),jQuery(".wpcf-pr-delete-ajax").live("click",function(){var e=confirm(wpcf_pr_del_warning);if(0==e)return!1;var t=jQuery(this);return jQuery.ajax({url:jQuery(this).attr("href"),type:"get",dataType:"json",cache:!1,beforeSend:function(){t.after('<div style="margin-top:20px;"></div>').next().addClass("wpcf-ajax-loading-small")},success:function(e){null!=e&&"undefined"!=typeof e.output&&t.parent().parent().fadeOut(function(){jQuery(this).remove(),wpcfRelationshipInit("","delete")}),t.next().fadeOut(function(){jQuery(this).remove()})}}),!1}),jQuery(".wpcf-pr-update-belongs").live("click",function(){var e=jQuery(this);return jQuery.ajax({url:jQuery(this).attr("href"),type:"post",dataType:"json",data:jQuery(this).attr("href")+"&"+e.prev().serialize(),cache:!1,beforeSend:function(){e.after('<div style="margin-top:20px;"></div>').next().addClass("wpcf-ajax-loading-small")},success:function(t){e.next().fadeOut(2e3,function(){jQuery(this).remove()})}}),!1}),jQuery(".wpcf-pr-pagination-link").live("click",function(){if(wpcfPrIsEdited()){var e=confirm(wpcf_pr_pagination_warning);if(0==e)return!1;window.wpcf_pr_edited=!1}var t=jQuery(this);return jQuery.ajax({url:jQuery(this).attr("href"),type:"get",dataType:"json",cache:!1,beforeSend:function(){t.after('<div style="margin-top:20px;"></div>').next().addClass("wpcf-ajax-loading-small")},success:function(e){null!=e&&"undefined"!=typeof e.output&&t.parents(".wpcf-relationship-save-all-update").html(e.output),t.next().fadeOut(function(){jQuery(this).remove()})}}),!1}),jQuery(".wpcf-pr-pagination-select").live("change",function(){if(wpcfPrIsEdited()){var e=confirm(wpcf_pr_pagination_warning);if(0==e)return!1;window.wpcf_pr_edited=!1}var t=jQuery(this);return jQuery.ajax({url:jQuery(this).val(),type:"get",dataType:"json",cache:!1,beforeSend:function(){t.after('<div style="margin-top:20px;"></div>').next().addClass("wpcf-ajax-loading-small")},success:function(e){null!=e&&"undefined"!=typeof e.output&&t.parents(".wpcf-pr-pagination-update").html(e.output),t.next().fadeOut(function(){jQuery(this).remove()})}}),!1}),jQuery(".wpcf-sortable a").live("click",function(){if(wpcfPrIsEdited()){var e=confirm(wpcf_pr_pagination_warning);if(0==e)return!1;window.wpcf_pr_edited=!1}var t=jQuery(this);return jQuery.ajax({url:jQuery(this).attr("href"),type:"get",dataType:"json",cache:!1,beforeSend:function(){t.after('<div style="margin-top:20px;"></div>').next().addClass("wpcf-ajax-loading-small")},success:function(e){null!=e&&"undefined"!=typeof e.output&&t.parents(".wpcf-pr-pagination-update").html(e.output),t.next().fadeOut(function(){jQuery(this).remove()})}}),!1}),jQuery(".wpcf-pr-save-ajax").live("click",function(){var e=jQuery(this),t=!0,i=e.parents("tr").find(":input");if(i.each(function(){0==jQuery("#post").validate().element(jQuery(this))&&0==wpcfConditionalIsHidden(jQuery(this))&&(t=!1)}),0==t)return!1;e.parent().parent().find(".wpcf-pr-edited").removeClass("wpcf-pr-edited");var n=e.parent().parent().height(),r=Math.round(1e4*Math.random());return window.wpcf_pr_edited=!1,jQuery.ajax({url:jQuery(this).attr("href"),type:"post",dataType:"json",data:i.serialize(),cache:!1,beforeSend:function(){e.parent().parent().after('<tr id="wpcf-pr-update-'+r+'"><td style="height: '+n+'px;"><div style="margin-top:20px;" class="wpcf-ajax-loading-small"></div></td></tr>').remove()},success:function(e){null!=e&&"undefined"!=typeof e.output&&(jQuery("#wpcf-pr-update-"+r).after(e.output).remove(),wpcfRelationshipInit("","save"))}}),!1}),jQuery(".wpcf-pr-save-all-link").live("click",function(){var e=jQuery(this);if("disabled"==e.attr("disabled"))return!1;e.attr("disabled","disabled");var t=e.parent().find("table"),i=t.find(":input");if("forced"!=window.wpcfRelationshipInitContex){var n=!0;if(i.each(function(){0==wpcfConditionalIsHidden(jQuery(this))&&0==jQuery("#post").validate().element(jQuery(this))&&(n=!1)}),0==n)return e.removeAttr("disabled"),!1}var r=Math.round(1e4*Math.random()),a=t.find("tbody").height();return window.wpcf_pr_edited=!1,t.find(".wpcf-pr-edited").removeClass("wpcf-pr-edited"),jQuery.ajax({url:jQuery(this).attr("href"),type:"post",dataType:"json",data:jQuery(this).attr("href")+"&"+e.parent().find(":input").serialize(),cache:!1,beforeSend:function(){t.find("tbody").empty().prepend('<tr id="wpcf-pr-update-'+r+'"><td style="height: '+a+'px;"><div style="margin-top:20px;" class="wpcf-ajax-loading-small"></div></td></tr>')},success:function(i){null!=i&&"undefined"!=typeof i.output&&(t.parents(".wpcf-relationship-save-all-update").replaceWith(i.output),e.removeAttr("disabled"),wpcfRelationshipInit("","save_all"))}}),!1}),jQuery("#icl_mcs_details table tbody tr").each(function(){var e=jQuery(this).find("td").html();-1!=e.search(/^_wpcf_belongs_.*?_id/)&&jQuery(this).hide()}),jQuery(".wpcf-relationship-items-per-page").live("change",function(){var e=jQuery(this),t=jQuery(this).parents(".wpcf-pr-pagination-update");jQuery.ajax({url:ajaxurl,type:"get",dataType:"json",data:e.data("action")+"&_wpcf_relationship_items_per_page="+jQuery(this).val(),cache:!1,beforeSend:function(){e.after('<div style="margin-top:20px;" class="wpcf-ajax-loading-small"></div>')},success:function(i){null!=i&&"undefined"!=typeof i.output&&(t.html(i.output),e.next().fadeOut())}})}),wpcfRelationshipInit("","init")});