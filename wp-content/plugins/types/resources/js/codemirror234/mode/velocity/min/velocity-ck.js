CodeMirror.defineMode("velocity",function(){function e(e){for(var r={},t=e.split(" "),n=0;n<t.length;++n)r[t[n]]=!0;return r}function r(e,r,t){return r.tokenize=t,t(e,r)}function t(e,t){var s=t.beforeParams;t.beforeParams=!1;var l=e.next();if('"'!=l&&"'"!=l||!t.inParams){if(/[\[\]{}\(\),;\.]/.test(l))return"("==l&&s?t.inParams=!0:")"==l&&(t.inParams=!1),null;if(/\d/.test(l))return e.eatWhile(/[\w\.]/),"number";if("#"==l&&e.eat("*"))return r(e,t,a);if("#"==l&&e.match(/ *\[ *\[/))return r(e,t,o);if("#"==l&&e.eat("#"))return e.skipToEnd(),"comment";if("$"==l)return e.eatWhile(/[\w\d\$_\.{}]/),u&&u.propertyIsEnumerable(e.current().toLowerCase())?"keyword":(t.beforeParams=!0,"builtin");if(c.test(l))return e.eatWhile(c),"operator";e.eatWhile(/[\w\$_{}]/);var m=e.current().toLowerCase();return i&&i.propertyIsEnumerable(m)?"keyword":f&&f.propertyIsEnumerable(m)||e.current().match(/^#[a-z0-9_]+ *$/i)&&"("==e.peek()?(t.beforeParams=!0,"keyword"):null}return r(e,t,n(l))}function n(e){return function(r,n){for(var a=!1,o,i=!1;null!=(o=r.next());){if(o==e&&!a){i=!0;break}a=!a&&"\\"==o}return i&&(n.tokenize=t),"string"}}function a(e,r){for(var n=!1,a;a=e.next();){if("#"==a&&n){r.tokenize=t;break}n="*"==a}return"comment"}function o(e,r){for(var n=0,a;a=e.next();){if("#"==a&&2==n){r.tokenize=t;break}"]"==a?n++:" "!=a&&(n=0)}return"meta"}var i=e("#end #else #break #stop #[[ #]] #{end} #{else} #{break} #{stop}"),f=e("#if #elseif #foreach #set #include #parse #macro #define #evaluate #{if} #{elseif} #{foreach} #{set} #{include} #{parse} #{macro} #{define} #{evaluate}"),u=e("$foreach.count $foreach.hasNext $foreach.first $foreach.last $foreach.topmost $foreach.parent $velocityCount"),c=/[+\-*&%=<>!?:\/|]/;return{startState:function(){return{tokenize:t,beforeParams:!1,inParams:!1}},token:function(e,r){return e.eatSpace()?null:r.tokenize(e,r)}}}),CodeMirror.defineMIME("text/velocity","velocity");