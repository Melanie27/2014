!function(){tinymce.create("tinymce.plugins.gcbplugin",{init:function(n,t){var e=this;n.addCommand("gcb_do",function(){n.windowManager.open({file:t+"/getgcb.php?a=1",width:400+parseInt(n.getLang("media.delta_width",0)),height:350+parseInt(n.getLang("media.delta_height",0)),inline:1},{plugin_url:t})}),n.addButton("gcb",{title:"Insert Global Content Block",image:t+"/block20.gif",onclick:function(){n.execCommand("gcb_do")}}),n.onBeforeSetContent.add(function(n,c){c.content=e._process_gcb(c.content,t)}),n.onPostProcess.add(function(n,t){t.get&&(t.content=e._get_gcb(t.content))})},_process_gcb:function(n,t){return n.replace(/\[contentblock([^\]]*)\]/g,function(n,e){var c=e.match(/img=(.[^\s]*)/),o="gcb.png";return null!=c&&c.length>1&&(o=c[1].replace(/^\s+/,"")),'<img src="'+t+"/../i/"+o+'" class="gcbitem mceItem" title="contentblock'+tinymce.DOM.encode(e)+'" />'})},_get_gcb:function(n){function t(n,t){return t=new RegExp(t+'="([^"]+)"',"g").exec(n),t?tinymce.DOM.decode(t[1]):""}return n.replace(/(<img[^>]+>)/g,function(n,e){var c=t(e,"class");return-1!=c.indexOf("gcbitem")?"["+tinymce.trim(t(e,"title"))+"]":n})},createControl:function(n,t){return null},getInfo:function(){return{longname:"Global Content Blocks",author:"Ben Magrill",authorurl:"http://wpxpert.com",infourl:"http://wpxpert.com/global-content-blocks",version:"1.1.1"}}}),tinymce.PluginManager.add("gcbplugin",tinymce.plugins.gcbplugin)}();