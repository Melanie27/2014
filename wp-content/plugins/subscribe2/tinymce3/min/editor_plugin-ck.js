!function(){tinymce.create("tinymce.plugins.Subscribe2Plugin",{init:function(e,n){var t='<img src="'+n+'/../include/spacer.gif" class="mceSubscribe2 mceItemNoResize" />',c="mceSubscribe2",o="[subscribe2]",s=[],i=new RegExp(/(\[|<!--)subscribe2.*(\]|-->)/g);e.addCommand("mceSubscribe2",function(){e.execCommand("mceInsertContent",0,t)}),e.addButton("subscribe2",{title:"Insert Subscribe2 Token",image:n+"/../include/s2_button.png",cmd:c}),e.onInit.add(function(){e.dom.loadCSS(n+"/css/content.css"),e.theme.onResolveName&&e.theme.onResolveName.add(function(n,t){"IMG"===t.node.nodeName&&e.dom.hasClass(t.node,c)&&(t.name="subscribe2")})}),e.onClick.add(function(e,n){n=n.target,"IMG"===n.nodeName&&e.dom.hasClass(n,c)&&e.selection.select(n)}),e.onNodeChange.add(function(e,n,t){n.setActive("subscribe2","IMG"===t.nodeName&&e.dom.hasClass(t,c))}),e.onBeforeSetContent.add(function(e,n){s=n.content.match(i),n.content=n.content.replace(i,t)}),e.onPostProcess.add(function(e,n){if(n.get){if(null!==s){var t;for(t=0;t<s.length;t++)n.content=n.content.replace(/<img[^>]+>/,function(e){return-1!==e.indexOf('class="mceSubscribe2')&&(e=s[t]),e})}n.content=n.content.replace(/<img[^>]+>/g,function(e){return-1!==e.indexOf('class="mceSubscribe2')&&(e=o),e})}})},getInfo:function(){return{longname:"Insert Subscribe2 Token",author:"Matthew Robinson",authorurl:"http://subscribe2.wordpress.com",infourl:"http://subscribe2.wordpress.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add("subscribe2",tinymce.plugins.Subscribe2Plugin)}();